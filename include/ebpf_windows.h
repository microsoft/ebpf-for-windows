// Copyright (c) Microsoft Corporation
// SPDX-License-Identifier: MIT
#pragma once

#include "framework.h"

// This file contains eBPF definitions needed by eBPF programs as well as
// the verifier and execution context.

// TODO - Convert all code that uses ebpf_program_type_old_t to use
// ebpf_program_type_t.
typedef enum _ebpf_program_type_old
{
    EBPF_PROGRAM_TYPE_UNSPECIFIED_OLD = 0,
    EBPF_PROGRAM_TYPE_XDP_OLD = 1,
    EBPF_PROGRAM_TYPE_BIND_OLD = 2
} ebpf_program_type_old_t;

typedef GUID ebpf_program_type_t;

typedef enum _ebpf_helper_function
{
    EBPF_LOOKUP_ELEMENT = 1,
    EBPF_UPDATE_ELEMENT = 2,
    EBPF_DELETE_ELEMENT = 3,
} ebpf_helper_function_t;

typedef enum _ebpf_error_code
{
    EBPF_ERROR_SUCCESS,
    EBPF_ERROR_OUT_OF_RESOURCES,
    EBPF_ERROR_NOT_FOUND,
    EBPF_ERROR_INVALID_PARAMETER,
    EBPF_ERROR_BLOCKED_BY_POLICY,
    EBPF_ERROR_NO_MORE_KEYS,
    EBPF_ERROR_INVALID_HANDLE,
    EBPF_ERROR_NOT_SUPPORTED,
    EBPF_ERROR_DUPLICATE_NAME,
    EBPF_ERROR_ARITHMETIC_OVERFLOW,
    EBPF_ERROR_EXTENSION_FAILED_TO_LOAD,
    EBPF_ERROR_INSUFFICIENT_BUFFER,
} ebpf_error_code_t;
