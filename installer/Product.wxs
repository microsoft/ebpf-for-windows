<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (c) Microsoft Corporation
SPDX-License-Identifier: MIT
-->
<?define ProductVersion="022C44B5-8969-4B75-8DB0-73F98B1BD7DC"?>
<?define UpgradeCode="B6BCACB1-C872-4159-ABCB-43A50668056C"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:ui="http://schemas.microsoft.com/wix/UIExtension" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
	<Product Id="$(var.ProductVersion)" Name="eBPF for Windows" Language="1033" Version="0.9.0" Manufacturer="Microsoft" UpgradeCode="$(var.UpgradeCode)">
		<Package Description="eBPF for Windows" InstallerVersion="301" Compressed="yes" InstallScope="perMachine" Manufacturer="Microsoft" Platform="x64" />
		<MajorUpgrade AllowSameVersionUpgrades="yes"
					  Disallow="yes" DisallowUpgradeErrorMessage="An older version of [ProductName] is already installed. Please remove it first."
					  AllowDowngrades="no" DowngradeErrorMessage="A newer version of [ProductName] is already installed. Please remove it first." Schedule="afterInstallFinalize" />
		<MediaTemplate EmbedCab="yes" />

		<!-- Define global properties -->
		<PropertyRef Id="WIX_ACCOUNT_LOCALSERVICE" />
		<Property Id="ARPCONTACT" Value="opencode@microsoft.com" />
		<Property Id="INSTALLFOLDER" Secure="yes">
			<RegistrySearch Id="FindInstallLocation" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Uninstall\[WIX_UPGRADE_DETECTED]" Name="InstallLocation" Type="raw" Win64="yes" />
		</Property>

		<!-- Install preconditions -->
		<Property Id="VC_REDIST_INSTALLED" Secure="yes">
			<RegistrySearch Id="VC_REDIST_RegKey" Type="raw" Root="HKLM" Key="SOFTWARE\Microsoft\VisualStudio\14.0\VC\Runtimes\X64" Name="Version"/>
		</Property>
		<Condition Message="This setup requires the 'VC++ Redistributable' v14.x to be installed. Please install it the from: https://aka.ms/vs/17/release/vc_redist.x64.exe">
			Installed OR VC_REDIST_INSTALLED
		</Condition>

		<!-- Define the Product features and installation steps -->
		<Feature Id="ProductFeature" Title="eBPF for Windows Installer" ConfigurableDirectory="INSTALLFOLDER" Display="expand" Level="1" Absent="disallow" AllowAdvertise="no" InstallDefault="local" TypicalDefault="install" >
			<Feature Id="eBPF_Runtime_Components" Level="1" Title="Runtime Components" Absent="disallow" Display="expand" AllowAdvertise="no" >
				<ComponentGroupRef Id="eBPF_Runtime_Components" />
				<ComponentGroupRef Id="eBPFCore_Driver" />
				<ComponentGroupRef Id="NetEbpfExt_Driver" />
				<?if $(var.IncludeJIT) = True ?>
				<?if $(var.Configuration) = Debug ?>
				<Feature Id="eBPF_Runtime_Components_JIT" Level="11" Title="JIT" Absent="allow" AllowAdvertise="no" >
					<ComponentGroupRef Id="eBPF_Service" />
				</Feature>
				<?endif?>
				<?if $(var.Configuration) = Release ?>
				<Feature Id="eBPF_Runtime_Components_JIT" Level="11" Title="JIT" Absent="allow" AllowAdvertise="no" >
					<ComponentGroupRef Id="eBPF_Service" />
				</Feature>
				<?endif?>
				<?endif?>
			</Feature>
			<Feature Id="eBPF_Development" Level="2" Title="Development components" Absent="allow" AllowAdvertise="no" >
				<ComponentGroupRef Id="eBPF_Development_include" />
				<ComponentGroupRef Id="eBPF_Development_include_asm" />
				<ComponentGroupRef Id="eBPF_Development_include_bpf" />
				<ComponentGroupRef Id="eBPF_Development_include_kernel" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_include" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_include_asm" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_include_linux" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_include_uapi" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_include_uapi_linux" />
				<ComponentGroupRef Id="eBPF_Development_include_libbpf_src" />
				<ComponentGroupRef Id="eBPF_Development_include_linux" />
				<ComponentGroupRef Id="eBPF_Development_include_net" />
				<ComponentGroupRef Id="eBPF_Development_include_uapi" />
				<ComponentGroupRef Id="eBPF_Development_include_uapi_linux" />
				<ComponentGroupRef Id="eBPF_Development_include_user" />
				<ComponentGroupRef Id="eBPF_Development_libs" />
				<ComponentGroupRef Id="eBPF_Development_scripts" />
			</Feature>
			<Feature Id="eBPF_Testing" Level="2" Title="Testing components" Absent="allow" AllowAdvertise="no">
				<ComponentGroupRef Id="eBPF_Testing_Components" />
				<ComponentGroupRef Id="eBPF_Testing_Components_bad" />
				<ComponentGroupRef Id="sample_ebpf_ext_Driver" />
			</Feature>
		</Feature>

		<InstallExecuteSequence>
			<!--Rollback sequence-->
			<Custom Action="eBPF_netsh_helper_uninstall_rollback" Before="eBPF_netsh_helper_install">NOT Installed</Custom>

			<Custom Action="eBPFCore_Driver_stop_rollback" Before="eBPFCore_Driver_install">NOT Installed</Custom>
			<Custom Action="eBPFCore_Driver_uninstall_rollback" Before="eBPFCore_Driver_install">NOT Installed</Custom>

			<Custom Action="NetEbpfExt_Driver_stop_rollback" Before="NetEbpfExt_Driver_install">NOT Installed</Custom>
			<Custom Action="NetEbpfExt_Driver_uninstall_rollback" Before="NetEbpfExt_Driver_install">NOT Installed</Custom>

			<Custom Action="sample_ebpf_ext_Driver_stop_rollback" Before="sample_ebpf_ext_Driver_install">NOT Installed</Custom>
			<Custom Action="sample_ebpf_ext_Driver_uninstall_rollback" Before="sample_ebpf_ext_Driver_install">NOT Installed</Custom>

			<!--Install sequence-->
			<Custom Action="Clear_eBPF_store" After="InstallFiles">NOT Installed</Custom>
			<Custom Action="Setup_eBPF_store" After="Clear_eBPF_store">NOT Installed</Custom>

			<Custom Action="eBPF_netsh_helper_install" After="Setup_eBPF_store">NOT Installed</Custom>

			<Custom Action="eBPFCore_Driver_install" After="Setup_eBPF_store">NOT Installed</Custom>
			<Custom Action="eBPFCore_Driver_start" After="eBPFCore_Driver_install">NOT Installed</Custom>

			<Custom Action="NetEbpfExt_Driver_install" After="Setup_eBPF_store">NOT Installed</Custom>
			<Custom Action="NetEbpfExt_Driver_start" After="NetEbpfExt_Driver_install">NOT Installed</Custom>

			<Custom Action="sample_ebpf_ext_Driver_install" After="Setup_eBPF_store">(NOT Installed AND <![CDATA[&eBPF_Testing=3]]>) OR (Installed AND <![CDATA[&eBPF_Testing=3]]>)</Custom>
			<Custom Action="sample_ebpf_ext_Driver_start" After="sample_ebpf_ext_Driver_install">(NOT Installed AND <![CDATA[&eBPF_Testing=3]]>) OR (Installed AND <![CDATA[&eBPF_Testing=3]]>)</Custom>

			<!--Uninstall sequence-->
			<Custom Action="eBPF_netsh_helper_uninstall" After="InstallInitialize">REMOVE="ALL"</Custom>

			<Custom Action="eBPFCore_Driver_stop" After="InstallInitialize">REMOVE="ALL"</Custom>
			<Custom Action="eBPFCore_Driver_uninstall" After="eBPFCore_Driver_stop">REMOVE="ALL"</Custom>

			<Custom Action="NetEbpfExt_Driver_stop" After="InstallInitialize">REMOVE="ALL"</Custom>
			<Custom Action="NetEbpfExt_Driver_uninstall" After="NetEbpfExt_Driver_stop">REMOVE="ALL"</Custom>

			<Custom Action="sample_ebpf_ext_Driver_stop" After="InstallInitialize">REMOVE="ALL" OR REMOVE="eBPF_Testing" OR REMOVE="eBPF_Development,eBPF_Testing"</Custom>
			<Custom Action="sample_ebpf_ext_Driver_uninstall" After="sample_ebpf_ext_Driver_stop">REMOVE="ALL" OR REMOVE="eBPF_Testing" OR REMOVE="eBPF_Development,eBPF_Testing"</Custom>

			<Custom Action="Clear_eBPF_store_uninstall" After="NetEbpfExt_Driver_uninstall">REMOVE="ALL"</Custom>
			<Custom Action="eBPFCore_Driver_uninstall_flush" After="InstallFinalize">REMOVE="ALL"</Custom>
		</InstallExecuteSequence>

		<!-- Define the UI style & behavior -->
		<UIRef Id="WixUI_FeatureTree" />
		<WixVariable Id="WixUILicenseRtf" Value="$(var.SolutionDir)LICENSE.rtf" />
		<WixVariable Id="WixUIBannerBmp" Value="res\eBPFBanner_493x58.bmp"/>
		<WixVariable Id="WixUIDialogBmp" Value="res\eBPFDialog_493x312.bmp"/>
		<CustomAction Id="SetWixInstallLocation" Property="ARPINSTALLLOCATION" Value="[INSTALLFOLDER]" />
		<InstallUISequence>
			<Custom Action="SetWixInstallLocation" After="CostFinalize" />
		</InstallUISequence>
		<UI />
	</Product>

	<!-- Define installation directories -->
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFiles64Folder">
				<Directory Id="INSTALLFOLDER" Name="ebpf-for-windows">
					<?if $(var.IncludeJIT) = True ?>
					<Directory Id="dir_JIT" Name="JIT" />
					<?endif?>
					<Directory Id="dir_drivers" Name="drivers"/>
					<Directory Id="dir_include" Name="include">
						<Directory Id="dir_include_asm" Name="asm" />
						<Directory Id="dir_include_bpf" Name="bpf" />
						<Directory Id="dir_include_kernel" Name="kernel" />
						<Directory Id="dir_include_libbpf" Name="libbpf">
							<Directory Id="dir_include_libbpf_include" Name="include">
								<Directory Id="dir_include_libbpf_include_asm" Name="asm" />
								<Directory Id="dir_include_libbpf_include_linux" Name="linux" />
								<Directory Id="dir_include_libbpf_include_uapi" Name="uapi">
									<Directory Id="dir_include_libbpf_include_uapi_linux" Name="linux" />
								</Directory>
							</Directory>
							<Directory Id="dir_include_libbpf_src" Name="src" />
						</Directory>
						<Directory Id="dir_include_linux" Name="linux" />
						<Directory Id="dir_include_net" Name="net" />
						<Directory Id="dir_include_uapi" Name="uapi">
							<Directory Id="dir_include_uapi_linux" Name="linux" />
						</Directory>
						<Directory Id="dir_include_user" Name="user" />
					</Directory>
					<Directory Id="dir_lib" Name="lib"/>
					<Directory Id="dir_scripts" Name="scripts"/>
					<Directory Id="dir_testing" Name="testing">
						<Directory Id="dir_testing_bad" Name="bad" />
					</Directory>
				</Directory>
			</Directory>
		</Directory>
	</Fragment>

	<!-- Define the product's <Runtime> components -->
	<Fragment>
		<ComponentGroup Id="eBPF_Runtime_Components" Directory="INSTALLFOLDER">
			<Component Id ="eBpfPATH" Guid="{C062B980-4B93-4FC7-A4F9-A751C2B419FD}" KeyPath="yes">
				<Environment Id="eBpfPATH" Name="PATH" Value="[INSTALLFOLDER]" Permanent="no" Part="last" Action="set" System="yes" Separator=";" />
			</Component>
			<Component Id="LICENSE" Guid="{AF22EAE5-7D8D-4F22-BB64-6B6A079A2947}">
				<File Id="LICENSE.txt" Name="LICENSE.txt" DiskId="1" Source="$(var.SolutionDir)LICENSE.txt" />
			</Component>
			<Component Id="BPF2C.EXE" DiskId="1" Guid="{BD23322B-91C3-4848-96E0-04E3745411E1}">
				<File Id="BPF2C.EXE" Name="bpf2c.exe" Source="$(var.bpf2c.TargetDir)bpf2c.exe" />
			</Component>
			<Component Id="BPF2C.PDB" DiskId="1" Guid="{6DEC471C-F27D-431C-A0E0-6F46CA472BAC}">
				<File Id="BPF2C.PDB" Name="bpf2c.pdb" Source="$(var.bpf2c.TargetDir)bpf2c.pdb" />
			</Component>
			<Component Id="EBPF_ALL.GUID" DiskId="1" Guid="{F3C808AC-A63B-4A29-B110-00B5A903F3C9}">
				<File Id="EBPF_ALL.GUID" Name="ebpf-all.guid" Source="$(var.SolutionDir)\scripts\ebpf-all.guid" />
			</Component>
			<Component Id="BPFTOOL.EXE" DiskId="1" Guid="{E168EB1A-35F6-47E3-B977-B16DF7DFBDB0}">
				<File Id="BPFTOOL.EXE" Name="bpftool.exe" Source="$(var.bpftool.TargetDir)bpftool.exe" />
			</Component>
			<Component Id="BPFTOOL.PDB" DiskId="1" Guid="{D2A6D747-A52C-43B9-A684-FF05A0DCE166}">
				<File Id="BPFTOOL.PDB" Name="bpftool.pdb" Source="$(var.bpftool.TargetDir)bpftool.pdb" />
			</Component>
			<Component Id="EBPFAPI.DLL" DiskId="1" Guid="{C44E4B08-901E-4B71-8FD1-F0B3D11D063F}">
				<File Id="EBPFAPI.DLL" Name="EbpfApi.dll" Source="$(var.EbpfApi.TargetDir)EbpfApi.dll" />
			</Component>
			<Component Id="EBPFAPI.PDB" DiskId="1" Guid="{6912E957-E682-41CB-9C53-1D0B886528F7}">
				<File Id="EBPFAPI.PDB" Name="EbpfApi.pdb" Source="$(var.EbpfApi.TargetDir)EbpfApi.pdb" />
			</Component>
			<Component Id="EBPF_PRINTK.GUID" DiskId="1" Guid="{77EB156D-046E-4BD6-8F57-CCA1DB031B0B}">
				<File Id="EBPF_PRINTK.GUID" Name="ebpf-printk.guid" Source="$(var.SolutionDir)\scripts\ebpf-printk.guid" />
			</Component>
			<Component Id="EBPFFORWINDOWS.WPRP" DiskId="1" Guid="{4E4838D3-0C49-4FA2-B8EE-E484CC0E7FA9}">
				<File Id="EBPFFORWINDOWS.WPRP" Name="ebpfforwindows.wprp" Source="$(var.SolutionDir)\scripts\ebpfforwindows.wprp" />
			</Component>
			<Component Id="EBPFNETSH.DLL" DiskId="1" Guid="{95928460-8560-448F-83C3-E9040BECCF5D}">
				<File Id="EBPFNETSH.DLL" Name="ebpfnetsh.dll" Source="$(var.ebpfnetsh.TargetDir)ebpfnetsh.dll" />
			</Component>
			<Component Id="EBPFNETSH.PDB" DiskId="1" Guid="{D0FB50BF-8822-4197-B3CF-0476C357DBDD}">
				<File Id="EBPFNETSH.PDB" Name="ebpfnetsh.pdb" Source="$(var.ebpfnetsh.TargetDir)ebpfnetsh.pdb" />
			</Component>
			<Component Id="EXPORT_PROGRAM_INFO.EXE" DiskId="1" Guid="{7AF9A30B-D7BF-4FD2-88C0-C2947ED55DCD}">
				<File Id="EXPORT_PROGRAM_INFO.EXE" Name="export_program_info.exe" Source="$(var.export_program_info.TargetDir)export_program_info.exe" />
			</Component>
			<Component Id="EXPORT_PROGRAM_INFO.PDB" DiskId="1" Guid="{88356FE4-6247-4876-BA14-42EDA88CC5C7}">
				<File Id="EXPORT_PROGRAM_INFO.PDB" Name="export_program_info.pdb" Source="$(var.export_program_info.TargetDir)export_program_info.pdb" />
			</Component>
		</ComponentGroup>

		<!--Clear/Setup the eBPF store-->
		<CustomAction Id="Clear_eBPF_store" ExeCommand='"[#EXPORT_PROGRAM_INFO.EXE]" --clear' Directory="INSTALLFOLDER" Execute="deferred" Return="check" Impersonate="yes"/>
		<CustomAction Id="Clear_eBPF_store_uninstall" ExeCommand='"[#EXPORT_PROGRAM_INFO.EXE]" --clear' Directory="INSTALLFOLDER" Execute="deferred" Return="ignore" Impersonate="yes"/>
		<SetProperty Id="Setup_eBPF_store" Value='"[#EXPORT_PROGRAM_INFO.EXE]"' Before="Setup_eBPF_store" Sequence="execute"/>
		<CustomAction Id="Setup_eBPF_store" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="yes"/>

		<!--Install/Uninstall the netsh helper-->
		<!--qtexec does not currently support a working directory (ref. https://github.com/wixtoolset/issues/issues/1265)-->
		<!--This workaround uses PowerShell to batch two commands, one to change the working directory, the other to execute the actual command from that directory.-->
		<SetProperty Id="eBPF_netsh_helper_install" Value="&quot;[WindowsFolder]System32\WindowsPowerShell\v1.0\powershell.exe&quot; -ExecutionPolicy Bypass &quot;cd '[INSTALLFOLDER]';netsh add helper ebpfnetsh.dll&quot;" Before="eBPF_netsh_helper_install" Sequence="execute"/>
		<CustomAction Id="eBPF_netsh_helper_install" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<SetProperty Id="eBPF_netsh_helper_uninstall" Value="&quot;[WindowsFolder]System32\WindowsPowerShell\v1.0\powershell.exe&quot; -ExecutionPolicy Bypass &quot;cd '[INSTALLFOLDER]';netsh delete helper ebpfnetsh.dll&quot;" Before="eBPF_netsh_helper_uninstall" Sequence="execute"/>
		<CustomAction Id="eBPF_netsh_helper_uninstall" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<SetProperty Id="eBPF_netsh_helper_uninstall_rollback" Value="&quot;[WindowsFolder]System32\WindowsPowerShell\v1.0\powershell.exe&quot; -ExecutionPolicy Bypass &quot;cd '[INSTALLFOLDER]';netsh delete helper ebpfnetsh.dll&quot;" Before="eBPF_netsh_helper_uninstall_rollback" Sequence="execute"/>
		<CustomAction Id="eBPF_netsh_helper_uninstall_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>

		<!--Install/Uninstall the eBPF Service -->
		<?if $(var.IncludeJIT) = True ?>
		<ComponentGroup Id="eBPF_Service" Directory="dir_JIT">
			<Component Id="EBPFSVC.PDB" DiskId="1" Guid="{D1935DF0-2FC7-42F5-81E5-19AF88D6244B}">
				<File Id="EBPFSVC.PDB" Name="EbpfSvc.pdb" Source="$(var.ebpfsvc.TargetDir)ebpfsvc.pdb" />
			</Component>
			<Component Id="eBPF_Service" Guid="{25F4F9A3-78EB-4598-9982-98FB65377A51}">
				<File Source="$(var.ebpfsvc.TargetPath)" KeyPath="yes" />
				<ServiceInstall Id="eBPFSvcInstaller" Name="eBPFSvc" DisplayName="eBPF Service" Description="eBPF Service"
								Start="auto"
								Type="ownProcess"
								ErrorControl="normal"
								Account="[WIX_ACCOUNT_LOCALSERVICE]"
								Vital="yes"
								Interactive="no">
					<ServiceConfig ServiceSid="restricted" OnInstall="yes" OnReinstall="yes" />
				</ServiceInstall>
				<ServiceControl Id="eBPFSvc_Start" Name="eBPFSvc"
								Start="install"
								Wait="no" />
				<ServiceControl Id="eBPFSvc_Stop" Name="eBPFSvc"
								Remove="uninstall"
								Stop="both"
								Wait="yes" />
			</Component>
		</ComponentGroup>
		<?endif?>

		<!--Install/Uninstall the eBPFCore Driver-->
		<!--A kernel driver service is not currently supported by the Windows Installer (Wix v3 - https://wixtoolset.org/docs/v3/xsd/wix/serviceinstall/).-->
		<ComponentGroup Id="eBPFCore_Driver" Directory="dir_drivers">
			<Component Id="eBPFCore.inf" Guid="{3D31A9C8-8BB0-48A2-94BD-CBA734438E0C}">
				<File Id="eBPFCore.inf" Name="eBPFCore.inf" Source="$(var.EbpfCore.TargetDir)eBPFCore.inf" KeyPath="yes"/>
			</Component>
			<Component Id="eBPFCore.sys" Guid="{5A6F4BA2-7FCB-48F7-BC6A-52C204E4A91A}">
				<File Id="eBPFCore.sys" Name="eBPFCore.sys" Source="$(var.EbpfCore.TargetPath)" KeyPath="yes" />
			</Component>
			<Component Id="eBPFCore.pdb" Guid="{DDE1BBD0-F440-4D54-97D0-D10DB511BACB}">
				<File Id="eBPFCore.pdb" Name="eBPFCore.pdb" Source="$(var.EbpfCore.TargetDir)eBPFCore.pdb" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<SetProperty Id="eBPFCore_Driver_install" Value='"sc.exe" create eBPFCore type=kernel start=auto binpath="[#eBPFCore.sys]"' Before="eBPFCore_Driver_install" Sequence="execute"/>
		<CustomAction Id="eBPFCore_Driver_install" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<Property Id="eBPFCore_Driver_start" Value='"net.exe" start eBPFCore' />
		<CustomAction Id="eBPFCore_Driver_start" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<Property Id="eBPFCore_Driver_stop" Value='"net.exe" stop eBPFCore' />
		<CustomAction Id="eBPFCore_Driver_stop" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="eBPFCore_Driver_uninstall" Value='"sc.exe" delete eBPFCore' />
		<CustomAction Id="eBPFCore_Driver_uninstall" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<CustomAction Id="eBPFCore_Driver_uninstall_flush" Directory="ProgramFiles64Folder" ExeCommand ='"sc.exe" query eBPFCore' Execute ="immediate" Return ="asyncNoWait"/>
		<Property Id="eBPFCore_Driver_stop_rollback" Value='"net.exe" stop eBPFCore' />
		<CustomAction Id="eBPFCore_Driver_stop_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>
		<Property Id="eBPFCore_Driver_uninstall_rollback" Value='"sc.exe" delete eBPFCore' />
		<CustomAction Id="eBPFCore_Driver_uninstall_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>

		<!--Install/Uninstall the NetEbpfExt Driver-->
		<!--A kernel driver service is not currently supported by the Windows Installer (Wix v3 - https://wixtoolset.org/docs/v3/xsd/wix/serviceinstall/).-->
		<ComponentGroup Id="NetEbpfExt_Driver" Directory="dir_drivers">
			<Component Id="NetEbpfExt.inf" Guid="{F1E813EE-665E-488C-84AA-0F47011C12F0}">
				<File Id="NetEbpfExt.inf" Name="NetEbpfExt.inf" Source="$(var.netebpfext.TargetDir)NetEbpfExt.inf" KeyPath="yes" />
			</Component>
			<Component Id="NetEbpfExt.sys" Guid="{3ADAA711-7F62-472A-A60D-589D543ED507}">
				<File Id="NetEbpfExt.sys" Name="NetEbpfExt.sys" Source="$(var.netebpfext.TargetPath)" KeyPath="yes" />
			</Component>
			<Component Id="NetEbpfExt.pdb" Guid="{3B35751C-693A-47C0-A258-97741D8B72CC}">
				<File Id="NetEbpfExt.pdb" Name="NetEbpfExt.pdb" Source="$(var.netebpfext.TargetDir)NetEbpfExt.pdb" KeyPath="yes" />
			</Component>
		</ComponentGroup>
		<SetProperty Id="NetEbpfExt_Driver_install" Value='"sc.exe" create NetEbpfExt type=kernel start=auto binpath="[#NetEbpfExt.sys]"' Before="NetEbpfExt_Driver_install" Sequence="execute"/>
		<CustomAction Id="NetEbpfExt_Driver_install" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<Property Id="NetEbpfExt_Driver_start" Value='"net.exe" start NetEbpfExt' />
		<CustomAction Id="NetEbpfExt_Driver_start" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<Property Id="NetEbpfExt_Driver_stop" Value='"net.exe" stop NetEbpfExt' />
		<CustomAction Id="NetEbpfExt_Driver_stop" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="NetEbpfExt_Driver_uninstall" Value='"sc.exe" delete NetEbpfExt' />
		<CustomAction Id="NetEbpfExt_Driver_uninstall" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="NetEbpfExt_Driver_stop_rollback" Value='"net.exe" stop NetEbpfExt' />
		<CustomAction Id="NetEbpfExt_Driver_stop_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>
		<Property Id="NetEbpfExt_Driver_uninstall_rollback" Value='"sc.exe" delete NetEbpfExt' />
		<CustomAction Id="NetEbpfExt_Driver_uninstall_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>
	</Fragment>

	<!-- Define the product's <Development> components -->
	<Fragment>
		<ComponentGroup Id="eBPF_Development_scripts" Directory="dir_scripts">
			<Component Id="CONVERT_BPFTONATIVE.PS1" DiskId="1" Guid="{DA950F9A-6448-4EE1-8B0B-4FE568E65177}">
				<File Id="CONVERT_BPFTONATIVE.PS1" Name="Convert-BpfToNative.ps1" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\Convert-BpfToNative.ps1" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include" Directory="dir_include">
			<Component Id="BPF_ENDIAN.H" DiskId="1" Guid="{59B40FBC-2842-449B-9101-CFBCCF785335}">
				<File Id="BPF_ENDIAN.H" Name="bpf_endian.h" Source="$(var.SolutionDir)include\bpf_endian.h" />
			</Component>
			<Component Id="BPF_HELPER_DEFS.H" DiskId="1" Guid="{EA36437E-777C-4FFE-ADF5-D806BBDB46FE}">
				<File Id="BPF_HELPER_DEFS.H" Name="bpf_helper_defs.h" Source="$(var.SolutionDir)include\bpf_helper_defs.h" />
			</Component>
			<Component Id="BPF_HELPERS.H" DiskId="1" Guid="{BD51CAA7-5D26-48C3-8822-EFB91AC0367E}">
				<File Id="BPF_HELPERS.H" Name="bpf_helpers.h" Source="$(var.SolutionDir)include\bpf_helpers.h" />
			</Component>
			<Component Id="BPF_HELPERS_PLATFORM.H" DiskId="1" Guid="{FD2EE81E-0EE7-4936-AA96-AAF7772164D3}">
				<File Id="BPF_HELPERS_PLATFORM.H" Name="bpf_helpers_platform.h" Source="$(var.SolutionDir)include\bpf_helpers_platform.h" />
			</Component>
			<Component Id="BPF2C.H" DiskId="1" Guid="{7C3950B4-29B2-4F39-BEEC-9FE18E08FE88}">
				<File Id="BPF2C.H" Name="bpf2c.h" Source="$(var.SolutionDir)include\bpf2c.h" />
			</Component>
			<Component Id="EBPF_API.H" DiskId="1" Guid="{0AAC29C6-1612-446F-BE6D-FFF42E032744}">
				<File Id="EBPF_API.H" Name="ebpf_api.h" Source="$(var.SolutionDir)include\ebpf_api.h" />
			</Component>
			<Component Id="EBPF_CORE_STRUCTS.H" DiskId="1" Guid="{C3814D22-4D03-420A-8AB3-BCF1E875C072}">
				<File Id="EBPF_CORE_STRUCTS.H" Name="ebpf_core_structs.h" Source="$(var.SolutionDir)include\ebpf_core_structs.h" />
			</Component>
			<Component Id="EBPF_EXECUTION_TYPE.H" DiskId="1" Guid="{451BE64A-5CD6-49BF-AF90-9CEFF55332A2}">
				<File Id="EBPF_EXECUTION_TYPE.H" Name="ebpf_execution_type.h" Source="$(var.SolutionDir)include\ebpf_execution_type.h" />
			</Component>
			<Component Id="EBPF_EXTENSION_UUIDS.H" DiskId="1" Guid="{02269617-BA66-4C22-A98D-CB699E785A35}">
				<File Id="EBPF_EXTENSION_UUIDS.H" Name="ebpf_extension_uuids.h" Source="$(var.SolutionDir)include\ebpf_extension_uuids.h" />
			</Component>
			<Component Id="EBPF_NETHOOKS.H" DiskId="1" Guid="{7BF41E29-AFCE-4B11-9DF7-BB2BED9B453F}">
				<File Id="EBPF_NETHOOKS.H" Name="ebpf_nethooks.h" Source="$(var.SolutionDir)include\ebpf_nethooks.h" />
			</Component>
			<Component Id="EBPF_PROGRAM_ATTACH_TYPE_GUIDS.H" DiskId="1" Guid="{ACDF9FAD-6C7B-49D0-9136-9FF0008BC5F0}">
				<File Id="EBPF_PROGRAM_ATTACH_TYPE_GUIDS.H" Name="ebpf_program_attach_type_guids.h" Source="$(var.SolutionDir)include\ebpf_program_attach_type_guids.h" />
			</Component>
			<Component Id="EBPF_PROGRAM_TYPES.H" DiskId="1" Guid="{15592AFC-A3CD-4A26-9F89-6656EB386354}">
				<File Id="EBPF_PROGRAM_TYPES.H" Name="ebpf_program_types.h" Source="$(var.SolutionDir)include\ebpf_program_types.h" />
			</Component>
			<Component Id="EBPF_RESULT.H" DiskId="1" Guid="{38D84F8F-1921-40F0-8A0D-13F02513CC93}">
				<File Id="EBPF_RESULT.H" Name="ebpf_result.h" Source="$(var.SolutionDir)include\ebpf_result.h" />
			</Component>
			<Component Id="EBPF_STORE_HELPER.H" DiskId="1" Guid="{14BE7BA2-DCD1-4AE1-A115-396E52CDF073}">
				<File Id="EBPF_STORE_HELPER.H" Name="ebpf_store_helper.h" Source="$(var.SolutionDir)include\ebpf_store_helper.h" />
			</Component>
			<Component Id="EBPF_STRUCTS.H" DiskId="1" Guid="{2D7F0268-8926-41C5-B592-5A3CEE10540D}">
				<File Id="EBPF_STRUCTS.H" Name="ebpf_structs.h" Source="$(var.SolutionDir)include\ebpf_structs.h" />
			</Component>
			<Component Id="EBPF_UTILITIES.H" DiskId="1" Guid="{24A4B689-2B6B-4431-BFB0-732388E41404}">
				<File Id="EBPF_UTILITIES.H" Name="ebpf_utilities.h" Source="$(var.SolutionDir)include\ebpf_utilities.h" />
			</Component>
			<Component Id="EBPF_WINDOWS.H" DiskId="1" Guid="{DFBF9B95-F1DF-4C08-A0D6-60556F3FA9EB}">
				<File Id="EBPF_WINDOWS.H" Name="ebpf_windows.h" Source="$(var.SolutionDir)include\ebpf_windows.h" />
			</Component>
			<Component Id="ELFIO_WRAPPER.HPP" DiskId="1" Guid="{FB1B409E-F5F7-40C8-AE05-C99E65CF7347}">
				<File Id="ELFIO_WRAPPER.HPP" Name="elfio_wrapper.hpp" Source="$(var.SolutionDir)include\elfio_wrapper.hpp" />
			</Component>
			<Component Id="GIT_COMMIT_ID.H" DiskId="1" Guid="{0AB71C9D-68E6-4892-A45D-306BA921CC07}">
				<File Id="GIT_COMMIT_ID.H" Name="git_commit_id.h" Source="$(var.SolutionDir)include\git_commit_id.h" />
			</Component>
			<Component Id="EBPF_BASE.H" DiskId="1" Guid="{FC47A44E-7747-4E98-AD55-09D9671C01C1}">
				<File Id="EBPF_BASE.H" Name="ebpf_base.h" Source="$(var.SolutionDir)external\ebpf-verifier\src\ebpf_base.h" />
			</Component>
			<Component Id="EBPF_EXTENSION.H" DiskId="1" Guid="{F5F5F5F5-7747-4E98-AD55-09D9671C01C1}">
				<File Id="EBPF_EXTENSION.H" Name="ebpf_extension.h" Source="$(var.SolutionDir)include\ebpf_extension.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_asm" Directory="dir_include_asm">
			<Component Id="ERRNO.H" DiskId="1" Guid="{DF63C9C1-FA9C-44E3-94EB-F77B7072E4BE}">
				<File Id="ERRNO.H" Name="errno.h" Source="$(var.SolutionDir)include\asm\errno.h" />
			</Component>
			<Component Id="POSIX_TYPES.H" DiskId="1" Guid="{F28F43DC-B53F-4DF9-8E19-F2D7E736E446}">
				<File Id="POSIX_TYPES.H" Name="posix_types.h" Source="$(var.SolutionDir)include\asm\posix_types.h" />
			</Component>
			<Component Id="TYPES.H" DiskId="1" Guid="{030CB7C2-BD80-4677-A183-890315E75EAC}">
				<File Id="TYPES.H" Name="types.h" Source="$(var.SolutionDir)include\asm\types.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_bpf" Directory="dir_include_bpf">
			<Component Id="BPF.H_1" DiskId="1" Guid="{A41E9DEB-709E-4DA3-9A24-F5B8C21AF30E}">
				<File Id="BPF.H_1" Name="bpf.h" Source="$(var.SolutionDir)include\bpf\bpf.h" />
			</Component>
			<Component Id="BPF_LEGACY.H" DiskId="1" Guid="{B3E387BA-03DB-4FE9-A808-B334D48F2CAA}">
				<File Id="BPF_LEGACY.H" Name="bpf_legacy.h" Source="$(var.SolutionDir)include\bpf\bpf_legacy.h" />
			</Component>
			<Component Id="HASHMAP.H" DiskId="1" Guid="{47680BD2-8931-4098-AFDF-57A5E4688BB5}">
				<File Id="HASHMAP.H" Name="hashmap.h" Source="$(var.SolutionDir)include\bpf\hashmap.h" />
			</Component>
			<Component Id="LIBBPF.H" DiskId="1" Guid="{2A878010-A1D6-4888-8694-FA4148259282}">
				<File Id="LIBBPF.H" Name="libbpf.h" Source="$(var.SolutionDir)include\bpf\libbpf.h" />
			</Component>
			<Component Id="LIBBPF_LEGACY.H" DiskId="1" Guid="{62760909-DD06-4711-AFE3-E4FD5A2FE940}">
				<File Id="LIBBPF_LEGACY.H" Name="libbpf_legacy.h" Source="$(var.SolutionDir)include\bpf\libbpf_legacy.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_kernel" Directory="dir_include_kernel">
			<Component Id="EBPF_REGISTRY_HELPER.H" DiskId="1" Guid="{26717067-176B-4B94-8716-57A675E5F918}">
				<File Id="EBPF_REGISTRY_HELPER.H" Name="ebpf_registry_helper.h" Source="$(var.SolutionDir)include\kernel\ebpf_registry_helper.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_linux" Directory="dir_include_linux">
			<Component Id="BPF.H_2" DiskId="1" Guid="{ED4F7D03-0334-4FB3-A3AC-1DAD36FF1228}">
				<File Id="BPF.H_2" Name="bpf.h" Source="$(var.SolutionDir)include\linux\bpf.h" />
			</Component>
			<Component Id="STDDEF.H" DiskId="1" Guid="{41D2F835-B4A7-450F-B064-1280C5D55505}">
				<File Id="STDDEF.H" Name="stddef.h" Source="$(var.SolutionDir)include\linux\stddef.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_net" Directory="dir_include_net">
			<Component Id="IF_ETHER.H_1" DiskId="1" Guid="{A1524B6C-6AE6-498F-AAB5-2527C2A4BC0A}">
				<File Id="IF_ETHER.H_1" Name="if_ether.h" Source="$(var.SolutionDir)include\net\if_ether.h" />
			</Component>
			<Component Id="IP.H_1" DiskId="1" Guid="{AC6F71A8-778B-4BEE-B409-DF0166A36482}">
				<File Id="IP.H_1" Name="ip.h" Source="$(var.SolutionDir)include\net\ip.h" />
			</Component>
			<Component Id="TCP.H_1" DiskId="1" Guid="{F8A57AE9-B14A-4FBF-8CC5-E164A5E63EB4}">
				<File Id="TCP.H_1" Name="tcp.h" Source="$(var.SolutionDir)include\net\tcp.h" />
			</Component>
			<Component Id="UDP.H" DiskId="1" Guid="{442722D8-B3F8-4820-933C-84406859579B}">
				<File Id="UDP.H" Name="udp.h" Source="$(var.SolutionDir)include\net\udp.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_uapi" Directory="dir_include_uapi" />
		<ComponentGroup Id="eBPF_Development_include_libbpf" Directory="dir_include_libbpf" />
		<ComponentGroup Id="eBPF_Development_include_libbpf_include" Directory="dir_include_libbpf_include" />
		<ComponentGroup Id="eBPF_Development_include_libbpf_include_asm" Directory="dir_include_libbpf_include_asm">
			<Component Id="BARRIER.H" DiskId="1" Guid="{999F024F-ECC5-4CD1-AAAA-39E185AFAB08}">
				<File Id="BARRIER.H" Name="barrier.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\asm\barrier.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_libbpf_include_linux" Directory="dir_include_libbpf_include_linux">
			<Component Id="COMPILER.H" DiskId="1" Guid="{417DA64B-E685-4EF6-8D96-18E9A41B003F}">
				<File Id="COMPILER.H" Name="compiler.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\compiler.h" />
			</Component>
			<Component Id="ERR.H" DiskId="1" Guid="{983B1790-3F35-45EF-9937-B0EDD9F2FA37}">
				<File Id="ERR.H" Name="err.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\err.h" />
			</Component>
			<Component Id="FILTER.H" DiskId="1" Guid="{60531224-DD83-4C83-BD25-688D2867681B}">
				<File Id="FILTER.H" Name="filter.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\filter.h" />
			</Component>
			<Component Id="KERNEL.H" DiskId="1" Guid="{8B0217C4-5DC9-4456-9912-AF98F2B56F80}">
				<File Id="KERNEL.H" Name="kernel.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\kernel.h" />
			</Component>
			<Component Id="LIST.H" DiskId="1" Guid="{E1D9D7E7-C942-4BCB-B8D2-014757A611F0}">
				<File Id="LIST.H" Name="list.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\list.h" />
			</Component>
			<Component Id="OVERFLOW.H" DiskId="1" Guid="{6BB5398C-E110-4496-A5DF-39401CFB6C7C}">
				<File Id="OVERFLOW.H" Name="overflow.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\overflow.h" />
			</Component>
			<Component Id="RING_BUFFER.H" DiskId="1" Guid="{5B9CEBE1-2C23-43A3-A48A-292766BE28B4}">
				<File Id="RING_BUFFER.H" Name="ring_buffer.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\ring_buffer.h" />
			</Component>
			<Component Id="TYPES_1.H" DiskId="1" Guid="{F624C418-861D-4F8D-B05A-7BFB075D35BE}">
				<File Id="TYPES_1.H" Name="types.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\linux\types.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_libbpf_include_uapi" Directory="dir_include_libbpf_include_uapi" />
		<ComponentGroup Id="eBPF_Development_include_libbpf_include_uapi_linux" Directory="dir_include_libbpf_include_uapi_linux">
			<Component Id="BPF.H_3" DiskId="1" Guid="{CBACC6D2-C5DC-4F47-9A10-873CFCE5900C}">
				<File Id="BPF.H_3" Name="bpf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\bpf.h" />
			</Component>
			<Component Id="BPF_COMMON.H" DiskId="1" Guid="{2F635111-E84D-4862-95FE-B94D14CD9BEC}">
				<File Id="BPF_COMMON.H" Name="bpf_common.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\bpf_common.h" />
			</Component>
			<Component Id="BTF.H" DiskId="1" Guid="{B8F4A5D4-5355-43D7-AE31-27B0905D04C3}">
				<File Id="BTF.H" Name="btf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\btf.h" />
			</Component>
			<Component Id="IF_LINK.H" DiskId="1" Guid="{4882B98F-B313-4D8F-A268-4082BCB6AFF5}">
				<File Id="IF_LINK.H" Name="if_link.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\if_link.h" />
			</Component>
			<Component Id="IF_XDP.H" DiskId="1" Guid="{5AABA8F2-4D4F-40D4-B273-ABC022DBA3A4}">
				<File Id="IF_XDP.H" Name="if_xdp.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\if_xdp.h" />
			</Component>
			<Component Id="NETLINK.H" DiskId="1" Guid="{9FE3D961-82F7-44EB-8941-0AF215F7BBFB}">
				<File Id="NETLINK.H" Name="netlink.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\netlink.h" />
			</Component>
			<Component Id="PERF_EVENT.H" DiskId="1" Guid="{287B4EA6-5AED-4791-A579-5FFEFE0B1901}">
				<File Id="PERF_EVENT.H" Name="perf_event.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\perf_event.h" />
			</Component>
			<Component Id="PKT_CLS.H" DiskId="1" Guid="{DA933141-A16D-4715-9C16-0B03F86A7A91}">
				<File Id="PKT_CLS.H" Name="pkt_cls.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\pkt_cls.h" />
			</Component>
			<Component Id="PKT_SCHED.H" DiskId="1" Guid="{CC3A71B7-7E14-4AF1-9F29-980E72C19A26}">
				<File Id="PKT_SCHED.H" Name="pkt_sched.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\include\uapi\linux\pkt_sched.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_libbpf_src" Directory="dir_include_libbpf_src">
			<Component Id="BPF_1.H" DiskId="1" Guid="{F08F4178-620F-4919-8F97-0A988EE22E6A}">
				<File Id="BPF_1.H" Name="bpf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf.h" />
			</Component>
			<Component Id="BPF_CORE_READ.H" DiskId="1" Guid="{421BC497-8EB2-460C-ACC0-39510D66C8B1}">
				<File Id="BPF_CORE_READ.H" Name="bpf_core_read.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_core_read.h" />
			</Component>
			<Component Id="BPF_ENDIAN_1.H" DiskId="1" Guid="{2C17136B-4451-4412-9764-E903B8AC1F06}">
				<File Id="BPF_ENDIAN_1.H" Name="bpf_endian.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_endian.h" />
			</Component>
			<Component Id="BPF_GEN_INTERNAL.H" DiskId="1" Guid="{C0F686E9-F086-41FD-9D3D-E23B84B942F9}">
				<File Id="BPF_GEN_INTERNAL.H" Name="bpf_gen_internal.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_gen_internal.h" />
			</Component>
			<Component Id="BPF_HELPERS_1.H" DiskId="1" Guid="{FF2CDD1A-BB03-4580-AC2B-5EC477E32ACE}">
				<File Id="BPF_HELPERS_1.H" Name="bpf_helpers.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_helpers.h" />
			</Component>
			<Component Id="BPF_HELPER_DEFS_1.H" DiskId="1" Guid="{9FD016D9-D5D3-4A11-BAC7-64BD68F1F61C}">
				<File Id="BPF_HELPER_DEFS_1.H" Name="bpf_helper_defs.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_helper_defs.h" />
			</Component>
			<Component Id="BPF_TRACING.H" DiskId="1" Guid="{DD88A4DF-C36D-4D48-B191-9C2E3C8768E8}">
				<File Id="BPF_TRACING.H" Name="bpf_tracing.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\bpf_tracing.h" />
			</Component>
			<Component Id="BTF_1.H" DiskId="1" Guid="{1D54C166-3E43-41A0-ABAC-941237C12A7E}">
				<File Id="BTF_1.H" Name="btf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\btf.h" />
			</Component>
			<Component Id="HASHMAP_1.H" DiskId="1" Guid="{C51AD9E3-9DF4-483B-844F-05B5F723330C}">
				<File Id="HASHMAP_1.H" Name="hashmap.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\hashmap.h" />
			</Component>
			<Component Id="LIBBPF_1.H" DiskId="1" Guid="{77100F8C-A601-45B8-AD07-3C2B0F31FCF4}">
				<File Id="LIBBPF_1.H" Name="libbpf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\libbpf.h" />
			</Component>
			<Component Id="LIBBPF_COMMON.H" DiskId="1" Guid="{46E4A472-4975-40F4-B825-1C26D5D71A15}">
				<File Id="LIBBPF_COMMON.H" Name="libbpf_common.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\libbpf_common.h" />
			</Component>
			<Component Id="LIBBPF_INTERNAL.H" DiskId="1" Guid="{EE258EDC-DDF9-44DB-92D1-93D33B45CF4D}">
				<File Id="LIBBPF_INTERNAL.H" Name="libbpf_internal.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\libbpf_internal.h" />
			</Component>
			<Component Id="LIBBPF_LEGACY_1.H" DiskId="1" Guid="{4C687F08-30C6-4298-9632-2CD91566669B}">
				<File Id="LIBBPF_LEGACY_1.H" Name="libbpf_legacy.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\libbpf_legacy.h" />
			</Component>
			<Component Id="LIBBPF_VERSION.H" DiskId="1" Guid="{763C6514-9295-436B-87DF-54789F444685}">
				<File Id="LIBBPF_VERSION.H" Name="libbpf_version.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\libbpf_version.h" />
			</Component>
			<Component Id="NLATTR.H" DiskId="1" Guid="{1624501C-4523-4E99-A594-274FDE8C1128}">
				<File Id="NLATTR.H" Name="nlattr.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\nlattr.h" />
			</Component>
			<Component Id="RELO_CORE.H" DiskId="1" Guid="{B911127B-3702-49F2-A97F-15268F905EE3}">
				<File Id="RELO_CORE.H" Name="relo_core.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\relo_core.h" />
			</Component>
			<Component Id="SKEL_INTERNAL.H" DiskId="1" Guid="{674B4B4C-968B-4593-948D-4BD623EC4E13}">
				<File Id="SKEL_INTERNAL.H" Name="skel_internal.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\skel_internal.h" />
			</Component>
			<Component Id="STRSET.H" DiskId="1" Guid="{00A310E8-6886-4C45-8BEA-F5121B2AAD0A}">
				<File Id="STRSET.H" Name="strset.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\strset.h" />
			</Component>
			<Component Id="STR_ERROR.H" DiskId="1" Guid="{E9AC241C-5A14-4C3B-96F4-AB79211DB9F4}">
				<File Id="STR_ERROR.H" Name="str_error.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\str_error.h" />
			</Component>
			<Component Id="USDT.BPF.H" DiskId="1" Guid="{7E29208F-3B05-4F1E-A425-1BD8759CD659}">
				<File Id="USDT.BPF.H" Name="usdt.bpf.h" KeyPath="yes" Source="$(var.SolutionDir)external\bpftool\libbpf\src\usdt.bpf.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_uapi_linux" Directory="dir_include_uapi_linux">
			<Component Id="BPF.H_4" DiskId="1" Guid="{CEF66B1A-8225-4B84-8239-C5238DA41BF2}">
				<File Id="BPF.H_4" Name="bpf.h" Source="$(var.SolutionDir)include\uapi\linux\bpf.h" />
			</Component>
			<Component Id="IF_ETHER.H" DiskId="1" Guid="{48230CCC-44D2-4875-91EF-12631D00A741}">
				<File Id="IF_ETHER.H" Name="if_ether.h" Source="$(var.SolutionDir)include\uapi\linux\if_ether.h" />
			</Component>
			<Component Id="IN.H" DiskId="1" Guid="{D7FFD894-2020-42C0-B6D3-10183CEC5452}">
				<File Id="IN.H" Name="in.h" Source="$(var.SolutionDir)include\uapi\linux\in.h" />
			</Component>
			<Component Id="IP.H" DiskId="1" Guid="{4A7B59AE-4F8C-4BFE-AD76-F42F04C494E4}">
				<File Id="IP.H" Name="ip.h" Source="$(var.SolutionDir)include\uapi\linux\ip.h" />
			</Component>
			<Component Id="TCP.H" DiskId="1" Guid="{A66521EB-BA4F-4741-969D-B727585BBE3C}">
				<File Id="TCP.H" Name="tcp.h" Source="$(var.SolutionDir)include\uapi\linux\tcp.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_include_user" Directory="dir_include_user">
			<Component Id="EBPF_REGISTRY_HELPER.H_1" DiskId="1" Guid="{D1BF1F4F-BD3D-484E-89D9-77A94522FC97}">
				<File Id="EBPF_REGISTRY_HELPER.H_1" Name="ebpf_registry_helper.h" Source="$(var.SolutionDir)include\user\ebpf_registry_helper.h" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Development_libs" Directory="dir_lib">
			<Component Id="eBPFApi_lib" Guid="{A164197B-3C57-4ECA-B138-CBF558DA4401}">
				<File Id="EbpfApi.lib" Name="EbpfApi.lib" DiskId="1" Source="$(var.api.TargetDir)EbpfApi.lib" />
			</Component>
		</ComponentGroup>
	</Fragment>

	<!-- Define the product's <Testing> components -->
	<Fragment>
		<ComponentGroup Id="eBPF_Testing_Components_bad" Directory="dir_testing_bad">
			<Component Id="BAD1.O" DiskId="1" Guid="{06A6BC9F-B4C6-43B5-953B-F890F257F136}">
				<File Id="BAD1.O" Name="bad1.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bad\bad1.o" />
			</Component>
			<Component Id="BAD2.O" DiskId="1" Guid="{3B9F0887-05CE-48A9-85CA-77D0A611700D}">
				<File Id="BAD2.O" Name="bad2.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bad\bad2.o" />
			</Component>
		</ComponentGroup>
		<ComponentGroup Id="eBPF_Testing_Components" Directory="dir_testing">
			<Component Id="API_TEST.EXE" DiskId="1" Guid="{70AA4D35-45C4-466A-AE08-64A38E4C50F2}">
				<File Id="API_TEST.EXE" Name="api_test.exe" Source="$(var.api_test.TargetDir)api_test.exe" />
			</Component>
			<Component Id="API_TEST.PDB" DiskId="1" Guid="{0884D5FB-CD5F-4780-892C-F9B37DF95989}">
				<File Id="API_TEST.PDB" Name="api_test.pdb" Source="$(var.api_test.TargetDir)api_test.pdb" />
			</Component>
			<Component Id="BAD_MAP_NAME.O" DiskId="1" Guid="{6FFEB06E-D0B0-4390-BF68-4163D190B5A7}">
				<File Id="BAD_MAP_NAME.O" Name="bad_map_name.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bad_map_name.o" />
			</Component>
			<Component Id="BAD_MAP_NAME_UM.DLL" DiskId="1" Guid="{CA9B3436-C77D-4B42-88BB-472ADFD6980F}">
				<File Id="BAD_MAP_NAME_UM.DLL" Name="bad_map_name_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bad_map_name_um.dll" />
			</Component>
			<Component Id="BAD_MAP_NAME_UM.PDB" DiskId="1" Guid="{520F9698-111B-4F03-9E60-84A6F5508DE1}">
				<File Id="BAD_MAP_NAME_UM.PDB" Name="bad_map_name_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bad_map_name_um.pdb" />
			</Component>
			<Component Id="BINDMONITOR.O" DiskId="1" Guid="{88D66354-E6DF-4BE4-B1D4-3F716A7F81AB}">
				<File Id="BINDMONITOR.O" Name="bindmonitor.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor.o" />
			</Component>
			<Component Id="BINDMONITOR.SYS" DiskId="1" Guid="{D36736C9-35B0-41AD-A19F-7E122035DC70}">
				<File Id="BINDMONITOR.SYS" Name="bindmonitor.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor.sys" />
			</Component>
			<Component Id="BINDMONITOR_UM.DLL" DiskId="1" Guid="{D7E035F7-7CF7-499A-8547-29E619068B21}">
				<File Id="BINDMONITOR_UM.DLL" Name="bindmonitor_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_um.dll" />
			</Component>
			<Component Id="BINDMONITOR_UM.PDB" DiskId="1" Guid="{0AADF5BA-B2CE-41EB-A9B2-0F22F47A1454}">
				<File Id="BINDMONITOR_UM.PDB" Name="bindmonitor_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_um.pdb" />
			</Component>
			<Component Id="BINDMONITOR_RINGBUF.O" DiskId="1" Guid="{BFF28F26-F7A5-44B0-9289-AD9F4A19E33E}">
				<File Id="BINDMONITOR_RINGBUF.O" Name="bindmonitor_ringbuf.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_ringbuf.o" />
			</Component>
			<Component Id="BINDMONITOR_RINGBUF.SYS" DiskId="1" Guid="{8CC623C1-D5E0-4D23-A9DF-B785C5F01E02}">
				<File Id="BINDMONITOR_RINGBUF.SYS" Name="bindmonitor_ringbuf.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_ringbuf.sys" />
			</Component>
			<Component Id="BINDMONITOR_RINGBUF_UM.DLL" DiskId="1" Guid="{ABA1E89F-C6B5-4EAB-812B-52D05DB1F11C}">
				<File Id="BINDMONITOR_RINGBUF_UM.DLL" Name="bindmonitor_ringbuf_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_ringbuf_um.dll" />
			</Component>
			<Component Id="BINDMONITOR_RINGBUF_UM.PDB" DiskId="1" Guid="{FB8688DC-43FB-475A-ADB5-B669A97A435C}">
				<File Id="BINDMONITOR_RINGBUF_UM.PDB" Name="bindmonitor_ringbuf_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_ringbuf_um.pdb" />
			</Component>
			<Component Id="BINDMONITOR_TAILCALL.O" DiskId="1" Guid="{6A37AE43-179A-46BD-97D5-3D02B6807765}">
				<File Id="BINDMONITOR_TAILCALL.O" Name="bindmonitor_tailcall.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_tailcall.o" />
			</Component>
			<Component Id="BINDMONITOR_TAILCALL.SYS" DiskId="1" Guid="{310B89C6-2EDB-41F8-8455-2738A07A6DF9}">
				<File Id="BINDMONITOR_TAILCALL.SYS" Name="bindmonitor_tailcall.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_tailcall.sys" />
			</Component>
			<Component Id="BINDMONITOR_TAILCALL_UM.DLL" DiskId="1" Guid="{16069864-43C3-4B4A-9409-4252228DA976}">
				<File Id="BINDMONITOR_TAILCALL_UM.DLL" Name="bindmonitor_tailcall_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_tailcall_um.dll" />
			</Component>
			<Component Id="BINDMONITOR_TAILCALL_UM.PDB" DiskId="1" Guid="{3FB015CB-382B-4A1F-A1A1-473A3F2A083E}">
				<File Id="BINDMONITOR_TAILCALL_UM.PDB" Name="bindmonitor_tailcall_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bindmonitor_tailcall_um.pdb" />
			</Component>
			<Component Id="BPF.O" DiskId="1" Guid="{EACD2AE9-0C63-4C0D-BC1D-FA698DB58A13}">
				<File Id="BPF.O" Name="bpf.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bpf.o" />
			</Component>
			<Component Id="BPF.SYS" DiskId="1" Guid="{2CDA8C95-AA03-41F1-949B-B203F0908227}">
				<File Id="BPF.SYS" Name="bpf.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bpf.sys" />
			</Component>
			<Component Id="BPF_CALL.O" DiskId="1" Guid="{438B5ECE-4410-477D-A60C-A5A68579791D}">
				<File Id="BPF_CALL.O" Name="bpf_call.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bpf_call.o" />
			</Component>
			<Component Id="BPF_CALL.SYS" DiskId="1" Guid="{D1F8B3BB-C3DF-4DDF-AD84-92A8613AA9C0}">
				<File Id="BPF_CALL.SYS" Name="bpf_call.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\bpf_call.sys" />
			</Component>
			<Component Id="BPFTOOL_TESTS.EXE" DiskId="1" Guid="{9F720714-FD99-44DA-AB6C-2FDA71258628}">
				<File Id="BPFTOOL_TESTS.EXE" Name="bpftool_test.exe" Source="$(var.bpftool_tests.TargetDir)bpftool_tests.exe" />
			</Component>
			<Component Id="BPFTOOL_TESTS.PDB" DiskId="1" Guid="{8D3E4E35-14D0-45BD-B5E5-036B8C4777C5}">
				<File Id="BPFTOOL_TESTS.PDB" Name="bpftool_test.pdb" Source="$(var.bpftool_tests.TargetDir)bpftool_tests.pdb" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT4.O" DiskId="1" Guid="{226DB1EF-7DF8-4D9C-BAE3-7ACFE28FE580}">
				<File Id="CGROUP_COUNT_CONNECT4.O" Name="cgroup_count_connect4.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect4.o" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT4.SYS" DiskId="1" Guid="{E91552C6-EC5B-4DEC-B5D2-23E0054498E4}">
				<File Id="CGROUP_COUNT_CONNECT4.SYS" Name="cgroup_count_connect4.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect4.sys" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT4_UM.DLL" DiskId="1" Guid="{814BAEF7-7FEC-442C-8FE4-74F06C9BE10B}">
				<File Id="CGROUP_COUNT_CONNECT4_UM.DLL" Name="cgroup_count_connect4_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect4_um.dll" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT4_UM.PDB" DiskId="1" Guid="{3F6D5AAA-F99E-4EB6-B084-CECBD974A850}">
				<File Id="CGROUP_COUNT_CONNECT4_UM.PDB" Name="cgroup_count_connect4.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect4_um.pdb" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT6.O" DiskId="1" Guid="{D5DE9C5B-4337-4557-80E4-6269E8FB0D89}">
				<File Id="CGROUP_COUNT_CONNECT6.O" Name="cgroup_count_connect6.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect6.o" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT6.SYS" DiskId="1" Guid="{ADD6BF4A-631D-4157-8F5A-4D9CEC13CB82}">
				<File Id="CGROUP_COUNT_CONNECT6.SYS" Name="cgroup_count_connect6.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect6.sys" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT6_UM.DLL" DiskId="1" Guid="{8F638443-533A-459F-91D8-BE0788D5E7E6}">
				<File Id="CGROUP_COUNT_CONNECT6_UM.DLL" Name="cgroup_count_connect6_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect6_um.dll" />
			</Component>
			<Component Id="CGROUP_COUNT_CONNECT6_UM.PDB" DiskId="1" Guid="{510478D0-0F1E-428E-998C-7347470459F6}">
				<File Id="CGROUP_COUNT_CONNECT6_UM.PDB" Name="cgroup_count_connect6.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_count_connect6_um.pdb" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT4.O" DiskId="1" Guid="{BE21906A-A547-42A5-8B24-5690049546C1}">
				<File Id="CGROUP_MT_CONNECT4.O" Name="cgroup_mt_connect4.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect4.o" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT4.SYS" DiskId="1" Guid="{9E8935F1-4B11-4F04-956A-547945F67758}">
				<File Id="CGROUP_MT_CONNECT4.SYS" Name="cgroup_mt_connect4.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect4.sys" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT4_UM.DLL" DiskId="1" Guid="{459D9477-D7B8-4521-AA35-9CB0336531D8}">
				<File Id="CGROUP_MT_CONNECT4_UM.DLL" Name="cgroup_mt_connect4_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect4_um.dll" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT4_UM.PDB" DiskId="1" Guid="{4B4FAAB3-DBFF-411B-94CC-C85FF2FDE633}">
				<File Id="CGROUP_MT_CONNECT4_UM.PDB" Name="cgroup_mt_connect4.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect4_um.pdb" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT6.O" DiskId="1" Guid="{E0BC11FC-4A26-4E03-9BAA-75126DB4286F}">
				<File Id="CGROUP_MT_CONNECT6.O" Name="cgroup_mt_connect6.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect6.o" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT6.SYS" DiskId="1" Guid="{7868E2CD-1DEE-4022-8584-A7634E6BB3A5}">
				<File Id="CGROUP_MT_CONNECT6.SYS" Name="cgroup_mt_connect6.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect6.sys" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT6_UM.DLL" DiskId="1" Guid="{0C5566A3-73DA-4894-8B2F-1281EF6C7B30}">
				<File Id="CGROUP_MT_CONNECT6_UM.DLL" Name="cgroup_mt_connect6_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect6_um.dll" />
			</Component>
			<Component Id="CGROUP_MT_CONNECT6_UM.PDB" DiskId="1" Guid="{DE4318D8-6EE3-417D-924D-8B83BB7F2FFB}">
				<File Id="CGROUP_MT_CONNECT6_UM.PDB" Name="cgroup_mt_connect6.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_mt_connect6_um.pdb" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR.O" DiskId="1" Guid="{6AF0B01D-554F-4918-8D00-AA4104DD5BE0}">
				<File Id="CGROUP_SOCK_ADDR.O" Name="cgroup_sock_addr.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr.o" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR.SYS" DiskId="1" Guid="{02B9F35C-03BA-477E-86C8-2FFFC1C6B525}">
				<File Id="CGROUP_SOCK_ADDR.SYS" Name="cgroup_sock_addr.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr.sys" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR_UM.DLL" DiskId="1" Guid="{27E04F5B-E13A-4D37-8CDE-BD18BD93A45B}">
				<File Id="CGROUP_SOCK_ADDR_UM.DLL" Name="cgroup_sock_addr_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr_um.dll" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR_UM.PDB" DiskId="1" Guid="{40BC9394-DE30-468D-ABA9-8DAC8C76D492}">
				<File Id="CGROUP_SOCK_ADDR_UM.PDB" Name="cgroup_sock_addr_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr_um.pdb" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR2.O" DiskId="1" Guid="{EC56B373-152C-4ECB-9491-266AE910FFEC}">
				<File Id="CGROUP_SOCK_ADDR2.O" Name="cgroup_sock_addr2.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr2.o" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR2.SYS" DiskId="1" Guid="{3AEDA230-16DB-40D5-AE53-3312460BC741}">
				<File Id="CGROUP_SOCK_ADDR2.SYS" Name="cgroup_sock_addr2.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr2.sys" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR2_UM.DLL" DiskId="1" Guid="{6CEFE90B-B8C4-4610-B295-302586D45704}">
				<File Id="CGROUP_SOCK_ADDR2_UM.DLL" Name="cgroup_sock_addr2_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr2_um.dll" />
			</Component>
			<Component Id="CGROUP_SOCK_ADDR2_UM.PDB" DiskId="1" Guid="{AF48035A-42DE-4383-AE5B-1645FF293F6F}">
				<File Id="CGROUP_SOCK_ADDR2_UM.PDB" Name="cgroup_sock_addr2_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\cgroup_sock_addr2_um.pdb" />
			</Component>
			<Component Id="DECAP_PERMIT_PACKET.O" DiskId="1" Guid="{EAD33B50-0E47-464B-A919-1A24B64C686A}">
				<File Id="DECAP_PERMIT_PACKET.O" Name="decap_permit_packet.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\decap_permit_packet.o" />
			</Component>
			<Component Id="DECAP_PERMIT_PACKET.SYS" DiskId="1" Guid="{CB70F111-B380-43E9-A938-4A812CBD24D4}">
				<File Id="DECAP_PERMIT_PACKET.SYS" Name="decap_permit_packet.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\decap_permit_packet.sys" />
			</Component>
			<Component Id="DIVIDE_BY_ZERO.O" DiskId="1" Guid="{DBCE744E-08BC-4241-816E-47D13E7F15DC}">
				<File Id="DIVIDE_BY_ZERO.O" Name="divide_by_zero.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\divide_by_zero.o" />
			</Component>
			<Component Id="DIVIDE_BY_ZERO.SYS" DiskId="1" Guid="{B691F6B8-65FF-45C6-A1EC-11E8EB15103F}">
				<File Id="DIVIDE_BY_ZERO.SYS" Name="divide_by_zero.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\divide_by_zero.sys" />
			</Component>
			<Component Id="DIVIDE_BY_ZERO_UM.DLL" DiskId="1" Guid="{7E4D6872-F0A5-4AEA-B95B-4F865B7805EF}">
				<File Id="DIVIDE_BY_ZERO_UM.DLL" Name="divide_by_zero_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\divide_by_zero_um.dll" />
			</Component>
			<Component Id="DIVIDE_BY_ZERO_UM.PDB" DiskId="1" Guid="{68021699-0454-4C6E-8220-0E8D58D3DC9F}">
				<File Id="DIVIDE_BY_ZERO_UM.PDB" Name="divide_by_zero_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\divide_by_zero_um.pdb" />
			</Component>
			<Component Id="DROPPACKET.O" DiskId="1" Guid="{32E91251-1D4F-48BA-978E-85F30E7903C5}">
				<File Id="DROPPACKET.O" Name="droppacket.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\droppacket.o" />
			</Component>
			<Component Id="DROPPACKET.SYS" DiskId="1" Guid="{9B9A5A98-782F-40FA-B3CF-118DEDEEE832}">
				<File Id="DROPPACKET.SYS" Name="droppacket.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\droppacket.sys" />
			</Component>
			<Component Id="DROPPACKET_UM.DLL" DiskId="1" Guid="{F4D422DB-ED15-48E2-8F99-B5BBA4B38EE1}">
				<File Id="DROPPACKET_UM.DLL" Name="droppacket_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\droppacket_um.dll" />
			</Component>
			<Component Id="DROPPACKET_UM.PDB" DiskId="1" Guid="{5579C444-7640-4C41-A214-33AC21D04C26}">
				<File Id="DROPPACKET_UM.PDB" Name="droppacket_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\droppacket_um.pdb" />
			</Component>
			<Component Id="DROPPACKET_UNSAFE.O" DiskId="1" Guid="{40156401-DDEA-4435-B559-E7071D251395}">
				<File Id="DROPPACKET_UNSAFE.O" Name="droppacket_unsafe.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\droppacket_unsafe.o" />
			</Component>
			<?if $(var.Configuration) = Debug ?>
			<Component Id="EMPY_UM.DLL" DiskId="1" Guid="{321F2303-53CC-4CF2-8D92-5FCA988BDCB5}">
				<File Id="EMPY_UM.DLL" Name="empty_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\empty_um.dll" />
			</Component>
			<Component Id="EMPY_UM.PDB" DiskId="1" Guid="{5A07EE87-FF00-47AB-BC15-0C8E1A5EF04F}">
				<File Id="EMPY_UM.PDB" Name="empty_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\empty_um.pdb" />
			</Component>
			<?endif?>
			<Component Id="ENCAP_REFLECT_PACKET.O" DiskId="1" Guid="{767274A3-97F5-4F35-BB27-1A7166708AD8}">
				<File Id="ENCAP_REFLECT_PACKET.O" Name="encap_reflect_packet.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\encap_reflect_packet.o" />
			</Component>
			<Component Id="ENCAP_REFLECT_PACKET.SYS" DiskId="1" Guid="{150DB22E-48FE-47C4-BD04-0F55F78360E3}">
				<File Id="ENCAP_REFLECT_PACKET.SYS" Name="encap_reflect_packet.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\encap_reflect_packet.sys" />
			</Component>
			<?if $(var.Configuration) = Debug ?>
			<Component Id="INVALID_MAPS1_UM.DLL" DiskId="1" Guid="{BC4496CD-3006-4EBF-96FE-D840E63E02AA}">
				<File Id="INVALID_MAPS1_UM.DLL" Name="invalid_maps1_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps1_um.dll" />
			</Component>
			<Component Id="INVALID_MAPS1_UM.PDB" DiskId="1" Guid="{FAA16483-274A-455E-AB84-31216F9302F8}">
				<File Id="INVALID_MAPS1_UM.PDB" Name="invalid_maps1_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps1_um.pdb" />
			</Component>
			<Component Id="INVALID_MAPS2_UM.DLL" DiskId="1" Guid="{65CB9F94-05BD-41A8-BF76-99BCF99B324E}">
				<File Id="INVALID_MAPS2_UM.DLL" Name="invalid_maps2_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps2_um.dll" />
			</Component>
			<Component Id="INVALID_MAPS2_UM.PDB" DiskId="1" Guid="{94D8208D-832A-4274-A142-6BF2BCE453B5}">
				<File Id="INVALID_MAPS2_UM.PDB" Name="invalid_maps2_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps2_um.pdb" />
			</Component>
			<Component Id="INVALID_MAPS3_UM.DLL" DiskId="1" Guid="{F29DFA6E-ED91-443D-971B-89401FAB7A15}">
				<File Id="INVALID_MAPS3_UM.DLL" Name="invalid_maps3_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps3_um.dll" />
			</Component>
			<Component Id="INVALID_MAPS3_UM.PDB" DiskId="1" Guid="{BC0A040E-E84D-471B-9E4B-D69968657300}">
				<File Id="INVALID_MAPS3_UM.PDB" Name="invalid_maps3_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_maps3_um.pdb" />
			</Component>
			<Component Id="INVALID_HELPERS_UM.DLL" DiskId="1" Guid="{D69A5C0D-C585-4EBC-BC31-D2F08C9E20D0}">
				<File Id="INVALID_HELPERS_UM.DLL" Name="invalid_helpers_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_helpers_um.dll" />
			</Component>
			<Component Id="INVALID_HELPERS_UM.PDB" DiskId="1" Guid="{FE948E83-D312-4D08-A8CE-3CC24F4E6526}">
				<File Id="INVALID_HELPERS_UM.PDB" Name="invalid_helpers_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\invalid_helpers_um.pdb" />
			</Component>
			<?endif?>
			<Component Id="MAP.O" DiskId="1" Guid="{C0461A4A-1195-4965-9710-8EED78A271F6}">
				<File Id="MAP.O" Name="map.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map.o" />
			</Component>
			<Component Id="MAP.SYS" DiskId="1" Guid="{F4A14D78-AF2D-4305-9253-2DFAD8E86B36}">
				<File Id="MAP.SYS" Name="map.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map.sys" />
			</Component>
			<Component Id="MAP_UM.DLL" DiskId="1" Guid="{80C8B103-6212-4F86-B6B3-05996C2639D0}">
				<File Id="MAP_UM.DLL" Name="map_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_um.dll" />
			</Component>
			<Component Id="MAP_UM.PDB" DiskId="1" Guid="{6F54DE00-C439-442D-8DAF-F0FE01E9D002}">
				<File Id="MAP_UM.PDB" Name="map_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_um.pdb" />
			</Component>
			<Component Id="MAP_IN_MAP.O" DiskId="1" Guid="{D5BF9636-2A17-4E6C-8EFF-824794F48A01}">
				<File Id="MAP_IN_MAP.O" Name="map_in_map.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map.o" />
			</Component>
			<Component Id="MAP_IN_MAP.SYS" DiskId="1" Guid="{6AF324AB-39CD-4189-A18F-7DA43EFFF6CD}">
				<File Id="MAP_IN_MAP.SYS" Name="map_in_map.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map.sys" />
			</Component>
			<Component Id="MAP_IN_MAP_UM.DLL" DiskId="1" Guid="{E625FEC7-6D4A-495C-B8CE-14D39F572719}">
				<File Id="MAP_IN_MAP_UM.DLL" Name="map_in_map_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_um.dll" />
			</Component>
			<Component Id="MAP_IN_MAP_UM.PDB" DiskId="1" Guid="{91D709F0-FABE-4EDF-9FB4-61E5EA633EBC}">
				<File Id="MAP_IN_MAP_UM.PDB" Name="map_in_map_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_um.pdb" />
			</Component>
			<Component Id="MAP_IN_MAP_V2.O" DiskId="1" Guid="{D198FFAB-E146-4ED3-96B3-9FBED450C7D7}">
				<File Id="MAP_IN_MAP_V2.O" Name="map_in_map_v2.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_v2.o" />
			</Component>
			<Component Id="MAP_IN_MAP_V2.SYS" DiskId="1" Guid="{69B33845-E670-4485-A004-414BB39AB8B7}">
				<File Id="MAP_IN_MAP_V2.SYS" Name="map_in_map_v2.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_v2.sys" />
			</Component>
			<Component Id="MAP_IN_MAP_V2_UM.DLL" DiskId="1" Guid="{F804A298-A598-4B2A-81C2-28D9021E1F54}">
				<File Id="MAP_IN_MAP_V2_UM.DLL" Name="map_in_map_v2_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_v2_um.dll" />
			</Component>
			<Component Id="MAP_IN_MAP_V2_UM.PDB" DiskId="1" Guid="{F2234642-B193-453E-B484-91E3028206F6}">
				<File Id="MAP_IN_MAP_V2_UM.PDB" Name="map_in_map_v2_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_in_map_v2_um.pdb" />
			</Component>
			<Component Id="MAP_REUSE.O" DiskId="1" Guid="{3C17B815-A950-4103-A9D3-DB8EB5F41B47}">
				<File Id="MAP_REUSE.O" Name="map_reuse.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse.o" />
			</Component>
			<Component Id="MAP_REUSE.SYS" DiskId="1" Guid="{48775CE6-281A-4D6F-906D-78B56AAE61A6}">
				<File Id="MAP_REUSE.SYS" Name="map_reuse.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse.sys" />
			</Component>
			<Component Id="MAP_REUSE_UM.DLL" DiskId="1" Guid="{064F62B7-74BE-4EB7-B6A1-312E0626837F}">
				<File Id="MAP_REUSE_UM.DLL" Name="map_reuse_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_um.dll" />
			</Component>
			<Component Id="MAP_REUSE_UM.PDB" DiskId="1" Guid="{B9D6D648-94B1-4BCD-942C-EDF5A0F2306F}">
				<File Id="MAP_REUSE_UM.PDB" Name="map_reuse_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_um.pdb" />
			</Component>
			<Component Id="MAP_REUSE_2.O" DiskId="1" Guid="{E32CF0E5-00E0-44D7-BE16-DD9FE35064D8}">
				<File Id="MAP_REUSE_2.O" Name="map_reuse_2.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_2.o" />
			</Component>
			<Component Id="MAP_REUSE_2.SYS" DiskId="1" Guid="{8FA5D9E9-4A40-4562-B0D0-6CBA97993C9C}">
				<File Id="MAP_REUSE_2.SYS" Name="map_reuse_2.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_2.sys" />
			</Component>
			<Component Id="MAP_REUSE_2_UM.DLL" DiskId="1" Guid="{0E1D94C2-7B89-486F-B757-9F8BA9BCABDE}">
				<File Id="MAP_REUSE_2_UM.DLL" Name="map_reuse_2_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_2_um.dll" />
			</Component>
			<Component Id="MAP_REUSE_2_UM.PDB" DiskId="1" Guid="{B5133346-F446-4CB8-8B49-CE3E813F9E74}">
				<File Id="MAP_REUSE_2_UM.PDB" Name="map_reuse_2_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\map_reuse_2_um.pdb" />
			</Component>
			<Component Id="PIDTGID.O" DiskId="1" Guid="{85723409-15B9-499B-94F1-2AE72A5C8D85}">
				<File Id="PIDTGID.O" Name="pidtgid.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\pidtgid.o" />
			</Component>
			<Component Id="PIDTGID.SYS" DiskId="1" Guid="{2CD5A445-523A-42F8-8965-0469A0415624}">
				<File Id="PIDTGID.SYS" Name="pidtgid.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\pidtgid.sys" />
			</Component>
			<Component Id="PRINTK.O" DiskId="1" Guid="{6E02C38D-1024-495C-93C7-F998D7052CE5}">
				<File Id="PRINTK.O" Name="printk.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\printk.o" />
			</Component>
			<Component Id="PRINTK.SYS" DiskId="1" Guid="{09399688-9C2F-47E2-B43E-330A4033013A}">
				<File Id="PRINTK.SYS" Name="printk.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\printk.sys" />
			</Component>
			<Component Id="PRINTK_LEGACY.O" DiskId="1" Guid="{AFBC4E58-B9E2-4107-9554-731143CA2C62}">
				<File Id="PRINTK_LEGACY.O" Name="printk_legacy.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\printk_legacy.o" />
			</Component>
			<Component Id="PRINTK_LEGACY.SYS" DiskId="1" Guid="{F4521398-B31B-4717-8446-14DF2CAA56A7}">
				<File Id="PRINTK_LEGACY.SYS" Name="printk_legacy.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\printk_legacy.sys" />
			</Component>
			<Component Id="PRINTK_UNSAFE.O" DiskId="1" Guid="{10CBDD8C-BE25-43FD-86BB-A3A7A3129CE0}">
				<File Id="PRINTK_UNSAFE.O" Name="printk_unsafe.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\printk_unsafe.o" />
			</Component>
			<Component Id="REFLECT_PACKET.O" DiskId="1" Guid="{4AA8E3D7-1453-468B-98EE-3340BE55BA9C}">
				<File Id="REFLECT_PACKET.O" Name="reflect_packet.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\reflect_packet.o" />
			</Component>
			<Component Id="REFLECT_PACKET.SYS" DiskId="1" Guid="{FDF38463-AA17-4064-8FEB-7F2D02BBB17E}">
				<File Id="REFLECT_PACKET.SYS" Name="reflect_packet.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\reflect_packet.sys" />
			</Component>
			<Component Id="RUN_TESTS.BAT" DiskId="1" Guid="{C263C5FF-4A39-4078-9406-545F7D41DA13}">
				<File Id="RUN_TESTS.BAT" Name="run_tests.bat" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\run_tests.bat" />
			</Component>
			<Component Id="SAMPLE_EXT_APP.EXE" DiskId="1" Guid="{901A57AF-4B88-4F14-B84D-61FEA2979C40}">
				<File Id="SAMPLE_EXT_APP.EXE" Name="sample_ext_app.exe" Source="$(var.sample_ext_app.TargetDir)sample_ext_app.exe" />
			</Component>
			<Component Id="SAMPLE_EXT_APP.PDB" DiskId="1" Guid="{9DE5D44E-0C55-4959-AF57-F5735E92089A}">
				<File Id="SAMPLE_EXT_APP.PDB" Name="sample_ext_app.pdb" Source="$(var.sample_ext_app.TargetDir)sample_ext_app.pdb" />
			</Component>
			<Component Id="SOCKOPS.O" DiskId="1" Guid="{AA322CED-530D-4E07-9786-56C1658F7230}">
				<File Id="SOCKOPS.O" Name="sockops.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\sockops.o" />
			</Component>
			<Component Id="SOCKOPS.SYS" DiskId="1" Guid="{335F6212-7C2C-4814-99E0-2A62CBE80C33}">
				<File Id="SOCKOPS.SYS" Name="sockops.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\sockops.sys" />
			</Component>
			<Component Id="TAIL_CALL.O" DiskId="1" Guid="{9DF26DC2-595C-4DED-9983-3802ADEC10D7}">
				<File Id="TAIL_CALL.O" Name="tail_call.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call.o" />
			</Component>
			<Component Id="TAIL_CALL.SYS" DiskId="1" Guid="{842D5A33-A004-4286-823C-09D5CAC7791C}">
				<File Id="TAIL_CALL.SYS" Name="tail_call.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call.sys" />
			</Component>
			<Component Id="TAIL_CALL_UM.DLL" DiskId="1" Guid="{7FB5BE0D-A9CB-493F-81C0-A54DA41FBE0C}">
				<File Id="TAIL_CALL_UM.DLL" Name="tail_call_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_um.dll" />
			</Component>
			<Component Id="TAIL_CALL_UM.PDB" DiskId="1" Guid="{1CA37AD4-CB7B-46CD-B46E-923013E999A1}">
				<File Id="TAIL_CALL_UM.PDB" Name="tail_call_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_um.pdb" />
			</Component>
			<Component Id="TAIL_CALL_BAD.O" DiskId="1" Guid="{98B8DA0B-18B3-4D74-B99B-A99F4D85CEE8}">
				<File Id="TAIL_CALL_BAD.O" Name="tail_call_bad.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_bad.o" />
			</Component>
			<Component Id="TAIL_CALL_BAD.SYS" DiskId="1" Guid="{16716C24-4C67-4481-BD44-63607A5F92EA}">
				<File Id="TAIL_CALL_BAD.SYS" Name="tail_call_bad.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_bad.sys" />
			</Component>
			<Component Id="TAIL_CALL_BAD_UM.DLL" DiskId="1" Guid="{0D4C5F32-98F8-4C72-9F79-1FB4C199CA04}">
				<File Id="TAIL_CALL_BAD_UM.DLL" Name="tail_call_bad_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_bad_um.dll" />
			</Component>
			<Component Id="TAIL_CALL_BAD_UM.PDB" DiskId="1" Guid="{F7318887-4F2B-4863-84D0-157914B31C38}">
				<File Id="TAIL_CALL_BAD_UM.PDB" Name="tail_call_bad_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_bad_um.pdb" />
			</Component>
			<Component Id="TAIL_CALL_MAP.O" DiskId="1" Guid="{A3F68C4D-00BF-4FB7-8B49-2BFC69AF7ABB}">
				<File Id="TAIL_CALL_MAP.O" Name="tail_call_map.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_map.o" />
			</Component>
			<Component Id="TAIL_CALL_MAP.SYS" DiskId="1" Guid="{5A163653-8F38-40D0-91CC-A9AF991668F3}">
				<File Id="TAIL_CALL_MAP.SYS" Name="tail_call_map.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_map.sys" />
			</Component>
			<Component Id="TAIL_CALL_MULTIPLE.O" DiskId="1" Guid="{2779762A-9B87-490B-83CF-30A0C0C28CF3}">
				<File Id="TAIL_CALL_MULTIPLE.O" Name="tail_call_multiple.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_multiple.o" />
			</Component>
			<Component Id="TAIL_CALL_MULTIPLE.SYS" DiskId="1" Guid="{F5B07483-3477-4D84-B209-B85A8C503B86}">
				<File Id="TAIL_CALL_MULTIPLE.SYS" Name="tail_call_multiple.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_multiple.sys" />
			</Component>
			<Component Id="TAIL_CALL_MULTIPLE_UM.DLL" DiskId="1" Guid="{3C43A424-FC1E-4DB5-9DBE-50F25B7F1E00}">
				<File Id="TAIL_CALL_MULTIPLE_UM.DLL" Name="tail_call_multiple_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_multiple_um.dll" />
			</Component>
			<Component Id="TAIL_CALL_MULTIPLE_UM.PDB" DiskId="1" Guid="{D918F2DB-BC80-406F-B0AD-0C340D5EF280}">
				<File Id="TAIL_CALL_MULTIPLE_UM.PDB" Name="tail_call_multiple_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\tail_call_multiple_um.pdb" />
			</Component>
			<Component Id="TEST_SAMPLE_EBPF.O" DiskId="1" Guid="{5E7F82E9-9631-44C6-A597-18DD96C87C44}">
				<File Id="TEST_SAMPLE_EBPF.O" Name="test_sample_ebpf.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\test_sample_ebpf.o" />
			</Component>
			<Component Id="TEST_SAMPLE_EBPF.SYS" DiskId="1" Guid="{4FFD5551-2C3C-44C8-AA5E-F72A64F94E20}">
				<File Id="TEST_SAMPLE_EBPF.SYS" Name="test_sample_ebpf.sys" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\test_sample_ebpf.sys" />
			</Component>
			<Component Id="TEST_UTILITY_HELPERS.O" DiskId="1" Guid="{B895F798-8A2D-4757-BDD2-F7A68860C92A}">
				<File Id="TEST_UTILITY_HELPERS.O" Name="test_utility_helpers.o" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\test_utility_helpers.o" />
			</Component>
			<Component Id="TEST_UTILITY_HELPERS_UM.DLL" DiskId="1" Guid="{1CCC5D7B-CC60-4967-9EA7-EC28E6B35005}">
				<File Id="TEST_UTILITY_HELPERS_UM.DLL" Name="test_utility_helpers_um.dll" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\test_utility_helpers_um.dll" />
			</Component>
			<Component Id="TEST_UTILITY_HELPERS_UM.PDB" DiskId="1" Guid="{71D4CB23-B5A6-445E-8C01-9DD66E803424}">
				<File Id="TEST_UTILITY_HELPERS_UM.PDB" Name="test_utility_helpers_um.pdb" Source="$(var.SolutionDir)$(var.Platform)\$(var.Configuration)\test_utility_helpers_um.pdb" />
			</Component>
			<Component Id="UNIT_TESTS.EXE" DiskId="1" Guid="{CCF26677-3DDF-424F-80E8-184F65E323BA}">
				<File Id="UNIT_TESTS.EXE" Name="unit_tests.exe" Source="$(var.unit_tests.TargetDir)unit_tests.exe" />
			</Component>
			<Component Id="UNIT_TESTS.PDB" DiskId="1" Guid="{3CF32625-22F9-4ABD-A0BF-44FA7EA2BCDE}">
				<File Id="UNIT_TESTS.PDB" Name="unit_tests.pdb" Source="$(var.unit_tests.TargetDir)unit_tests.pdb" />
			</Component>
			<Component Id="XDP_TESTS.EXE" DiskId="1" Guid="{6A98B162-1DC5-4145-A91B-9DF757766119}">
				<File Id="XDP_TESTS.EXE" Name="xdp_tests.exe" Source="$(var.xdp_tests.TargetDir)xdp_tests.exe" />
			</Component>
			<Component Id="XDP_TESTS.PDB" DiskId="1" Guid="{5540AA7D-73F0-418B-995B-8A9C163C3939}">
				<File Id="XDP_TESTS.PDB" Name="xdp_tests.pdb" Source="$(var.xdp_tests.TargetDir)xdp_tests.pdb" />
			</Component>
			<Component Id="EBPF_STRESS_TESTS_KM.EXE" DiskId="1" Guid="{321DF939-A3CE-4FA1-A9E0-980A83C10855}">
				<File Id="EBPF_STRESS_TESTS_KM.EXE" Name="ebpf_stress_tests_km.exe" Source="$(var.ebpf_stress_tests_km.TargetDir)ebpf_stress_tests_km.exe" />
			</Component>
			<Component Id="EBPF_STRESS_TESTS_KM.PDB" DiskId="1" Guid="{47013057-2AE5-4A42-BAE5-BF1D08983F5E}">
				<File Id="EBPF_STRESS_TESTS_KM.PDB" Name="ebpf_stress_tests_km.pdb" Source="$(var.ebpf_stress_tests_km.TargetDir)ebpf_stress_tests_km.pdb" />
			</Component>
			<Component Id="EBPF_STRESS_TESTS_UM.EXE" DiskId="1" Guid="{E156A698-CD2F-49BF-86B0-C0E1AECE51CF}">
				<File Id="EBPF_STRESS_TESTS_UM.EXE" Name="ebpf_stress_tests_um.exe" Source="$(var.ebpf_stress_tests_um.TargetDir)ebpf_stress_tests_um.exe" />
			</Component>
			<Component Id="EBPF_STRESS_TESTS_UM.PDB" DiskId="1" Guid="{C4A2836B-A59E-491D-A6B2-246EFCB622BA}">
				<File Id="EBPF_STRESS_TESTS_UM.PDB" Name="ebpf_stress_tests_um.pdb" Source="$(var.ebpf_stress_tests_um.TargetDir)ebpf_stress_tests_um.pdb" />
			</Component>
		</ComponentGroup>

		<!--Install/Uninstall sample_ebpf_ext Driver-->
		<!--A kernel driver service is not currently supported by the Windows Installer (Wix v3 - https://wixtoolset.org/docs/v3/xsd/wix/serviceinstall/).-->
		<ComponentGroup Id="sample_ebpf_ext_Driver" Directory="dir_testing">
			<Component Id="SAMPLE_EBPF_EXT.SYS" Guid="{027287AF-9945-4CD9-B863-8E39712612F7}">
				<File Id="SAMPLE_EBPF_EXT.SYS" Name="sample_ebpf_ext.sys" Source="$(var.sample_ebpf_ext.TargetPath)" />
			</Component>
			<Component Id="SAMPLE_EBPF_EXT.PDB" Guid="{B77B362A-BC02-46E8-B2BB-05D0981B1CC9}">
				<File Id="SAMPLE_EBPF_EXT.PDB" Name="sample_ebpf_ext.pdb" Source="$(var.sample_ebpf_ext.TargetDir)sample_ebpf_ext.pdb" />
			</Component>
		</ComponentGroup>
		<SetProperty Id="sample_ebpf_ext_Driver_install" Value='"sc.exe" create SampleEbpfExt type=kernel start=auto binpath="[#SAMPLE_EBPF_EXT.SYS]"' Before="sample_ebpf_ext_Driver_install" Sequence="execute"/>
		<CustomAction Id="sample_ebpf_ext_Driver_install" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="check" Impersonate="no"/>
		<Property Id="sample_ebpf_ext_Driver_start" Value='"net.exe" start SampleEbpfExt' />
		<CustomAction Id="sample_ebpf_ext_Driver_start" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="sample_ebpf_ext_Driver_stop" Value='"net.exe" stop SampleEbpfExt' />
		<CustomAction Id="sample_ebpf_ext_Driver_stop" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="sample_ebpf_ext_Driver_uninstall" Value='"sc.exe" delete SampleEbpfExt' />
		<CustomAction Id="sample_ebpf_ext_Driver_uninstall" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="deferred" Return="ignore" Impersonate="no"/>
		<Property Id="sample_ebpf_ext_Driver_stop_rollback" Value='"net.exe" stop SampleEbpfExt' />
		<CustomAction Id="sample_ebpf_ext_Driver_stop_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>
		<Property Id="sample_ebpf_ext_Driver_uninstall_rollback" Value='"sc.exe" delete SampleEbpfExt' />
		<CustomAction Id="sample_ebpf_ext_Driver_uninstall_rollback" BinaryKey="WixCA" DllEntry="WixQuietExec64" Execute="rollback" Return="ignore" Impersonate="no"/>
	</Fragment>
</Wix>